C C-spinlock-14-1.litmus
{
  atomic_t x = 0;
  spinlock_t x_lock;
}

P0(intptr_t *x, spinlock_t *x_lock)
{
    int r0 = spin_trylock(x_lock);
    if(r0){
        int r1 = READ_ONCE(*x);
        WRITE_ONCE(*x, r1 + 1);
        spin_unlock(x_lock);
    }
}

forall (0:r0=1 /\ x=1)