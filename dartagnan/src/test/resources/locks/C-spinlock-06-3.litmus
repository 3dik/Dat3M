C C-spinlock-06-3.litmus
"Deadlock"

{
  atomic_t x = 0;
  spinlock_t x_lock = 1;
  spinlock_t y_lock = 0;
}

P0(intptr_t *x, spinlock_t *x_lock, spinlock_t *y_lock)
{
    spin_lock(y_lock);
    spin_lock(x_lock);
    WRITE_ONCE(*x, 4);
    spin_unlock(x_lock);
    spin_unlock(y_lock);
}

P1(intptr_t *x, spinlock_t *x_lock)
{
    spin_lock(y_lock);
    WRITE_ONCE(*x, 3);
    spin_unlock(x_lock);
    spin_unlock(y_lock);
}

exists x=0